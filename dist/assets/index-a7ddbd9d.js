var v=Object.defineProperty;var P=(a,e,t)=>e in a?v(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var n=(a,e,t)=>(P(a,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();class T{constructor(e){this.components={},this.componentsClassList={},this.nodeAttributeSelector=(e==null?void 0:e.nodeAttributeSelector)||T.DEFAULT_NODE_ATTRIBUTE_SELECTOR}registerComponent(e,t){this.componentsClassList[e]=t}initComponents(){try{document.querySelectorAll(`[${this.nodeAttributeSelector}]`).forEach(e=>{const t=e.getAttribute(this.nodeAttributeSelector);if(t===null)throw["[ABS] The following node's component data attribute value is null:",e];if(this.componentsClassList[t]===void 0)throw`[ABS] Component initializer error: component "${t}" is not registered`;this.components[t]===void 0&&(this.components[t]=[]);const i=this.componentsClassList[t],s=new i(e);s.init(),this.components[t].push(s)}),Object.keys(this.components).forEach(e=>{this.components[e].forEach(t=>{t.ready&&t.ready()})})}catch(e){Array.isArray(e)?console.error(...e):console.error(e)}}initComponent(e){try{const t=e.getAttribute(this.nodeAttributeSelector);if(t===null)throw["[ABS] The following node's component data attribute value is null:",e];if(this.componentsClassList[t]===void 0)throw`[ABS] Component initializer error: component "${t}" is not registered`;this.components[t]===void 0&&(this.components[t]=[]);const i=this.componentsClassList[t],s=new i(e);s.init(),this.components[t].push(s),s.ready&&s.ready()}catch(t){Array.isArray(t)?console.error(...t):console.error(t)}}getComponentByNode(e){let t=null;const i=e.getAttribute(this.nodeAttributeSelector);if(i&&this.components[i]){const s=this.components[i].find(o=>o.node===e);s&&(t=s)}return t}destroyComponent(e){Object.keys(this.components).forEach(t=>{if(this.components[t].find(s=>s===e)){e.node.querySelectorAll(`[${this.nodeAttributeSelector}]`).forEach(r=>{const E=this.getComponentByNode(r);E&&this.destroyComponent(E)}),e.destroy&&e.destroy(),e.node.remove();const o=this.components[t].indexOf(e);this.components[t].splice(o,1)}})}purgeComponentsList(){Object.keys(this.components).forEach(e=>{this.components[e].forEach(t=>{const i=t.node.getAttribute(this.nodeAttributeSelector);!!document.querySelector(`[${this.nodeAttributeSelector}="${i}"]`)||this.destroyComponent(t)})})}}T.DEFAULT_NODE_ATTRIBUTE_SELECTOR="data-abs-component";const L={gradient:{steps:[]}},I=[{colorCode:"000000",position:0},{colorCode:"FFFFFF",position:100}],O="gradientchange";class R{constructor(e){n(this,"STEPS_LIST_SELECTOR",".gradient-generator-step-list");n(this,"STEP_SELECTOR",".gradient-generator-step-list-item");n(this,"STEP_COLOR_PREVIEW_SELECTOR",".gradient-generator-step-color-preview");n(this,"STEP_COLOR_INPUT_SELECTOR",".gradient-generator-step-color-hex-input");n(this,"STEP_POSITION_INPUT_SELECTOR",".gradient-generator-step-position-input");n(this,"DELETE_STEP_BUTTON_SELECTOR",".gradient-generator-step-control-delete");n(this,"ADD_STEP_BUTTON_SELECTOR",".gradient-generator-control-add");n(this,"STEP_ITEM_TEMPLATE_SELECTOR",".template#step-item-template>*");n(this,"GRADIENT_IMPORT_VIEW_SELECTOR",".gradient-generator-view-import");n(this,"GRADIENT_IMPORT_VIEW_OPEN_BUTTON_SELECTOR",".gradient-generator-control-import");n(this,"GRADIENT_IMPORT_VIEW_CLOSE_BUTTON_SELECTOR",".gradient-generator-view-import-close");n(this,"GRADIENT_IMPORT_INPUT_SELECTOR",".gradient-generator-view-import-input");n(this,"GRADIENT_IMPORT_BUTTON_SELECTOR",".gradient-generator-view-import-action");n(this,"GRADIENT_EXPORT_VIEW_SELECTOR",".gradient-generator-view-export");n(this,"GRADIENT_EXPORT_VIEW_OPEN_BUTTON_SELECTOR",".gradient-generator-control-export");n(this,"GRADIENT_EXPORT_VIEW_CLOSE_BUTTON_SELECTOR",".gradient-generator-view-export-close");n(this,"GRADIENT_EXPORT_INPUT_SELECTOR",".gradient-generator-view-export-input");n(this,"HIDE_OVERLAY_VIEW_CLASS","not-visible");n(this,"GRADIENT_GENERATOR_DISABLED_CLASS","disabled");n(this,"GRADIENT_ANGLE_INPUT_SELECTOR",".gradient-generator-frame-angle-input");n(this,"FRAME_SIZE_INPUT_SELECTOR",".gradient-generator-frame-size-input");n(this,"STEP_MIN_VALUE",0);n(this,"STEP_MAX_VALUE",100);n(this,"LAST_GRADIENT_DATA_STORAGE_KEY","abs.framerJs.gradientGenerator.lastGeneratedData");n(this,"GRADIENT_CHANGE_EVENT_NAME",O);n(this,"isComponentInited",!1);n(this,"stepTemplateNode",null);n(this,"templateSteps",[]);n(this,"output",L);n(this,"onChange",new CustomEvent(this.GRADIENT_CHANGE_EVENT_NAME,{}));this.node=e}init(){}ready(){if(!this.isComponentInited){this.isComponentInited=!this.isComponentInited,this.node.classList.remove(this.GRADIENT_GENERATOR_DISABLED_CLASS),this.stepTemplateNode=document.querySelector(this.STEP_ITEM_TEMPLATE_SELECTOR),this.updateStepsListFromTemplate();const e=JSON.parse(localStorage.getItem(this.LAST_GRADIENT_DATA_STORAGE_KEY));e!==null?this.reloadStoredData(e):this.generateDefaultGradient(),this.sortSteps(),this.templateSteps.forEach(t=>{this.assignEventsToStep(t)}),this.assignGlobalEvents()}}updateStepsListFromTemplate(){this.templateSteps=this.node.querySelectorAll(this.STEP_SELECTOR)}assignEventsToStep(e){const t=e.querySelector(this.STEP_COLOR_PREVIEW_SELECTOR),i=e.querySelector(this.STEP_COLOR_INPUT_SELECTOR),s=e.querySelector(this.STEP_POSITION_INPUT_SELECTOR),o=e.querySelector(this.DELETE_STEP_BUTTON_SELECTOR);i.addEventListener("input",()=>{this.updateColorPreview(i,t),this.updateOutput()}),i.addEventListener("paste",r=>{let E=(r.clipboardData||window.clipboardData).getData("text");E.indexOf("#")===0&&(E=E.split("#")[1]||E),i.value=E,this.updateColorPreview(i,t),this.updateOutput()}),s.addEventListener("change",()=>{this.sortSteps(),this.forceNumberInputLimit(s),this.updateOutput()}),o.addEventListener("click",()=>{this.deleteStep(e),this.updateOutput()})}updateColorPreview(e,t){const i=e.value||"000000";t.setAttribute("style",`background-color: #${i};`)}forceNumberInputLimit(e){const t=parseInt(e.getAttribute("min")),i=parseInt(e.getAttribute("max")),s=parseInt(e.value);e.value=s<t?`${t}`:s>i?`${i}`:`${s}`}addNewStep(e){var s,o;const t=(s=this.stepTemplateNode)==null?void 0:s.cloneNode(!0);if(this.node.querySelector(this.STEPS_LIST_SELECTOR).appendChild(t),this.assignEventsToStep(t),e){const r=t.querySelector(this.STEP_COLOR_INPUT_SELECTOR),E=t.querySelector(this.STEP_POSITION_INPUT_SELECTOR);r.value=e.colorCode,E.value=(o=e==null?void 0:e.position)==null?void 0:o.toString(),r.dispatchEvent(new Event("input")),E.dispatchEvent(new Event("change"))}return this.updateStepsListFromTemplate(),this.updateOutput(),t}deleteStep(e){e.remove(),this.updateStepsListFromTemplate(),this.updateOutput()}generateDefaultGradient(){I.forEach(e=>{this.addNewStep({colorCode:e.colorCode,position:e.position})})}sortSteps(){var o,r,E;const e=document.querySelector(this.STEPS_LIST_SELECTOR);let t,i=!0,s=!1;for(;i;){i=!1;const c=e==null?void 0:e.querySelectorAll(this.STEP_SELECTOR);for(t=0;t<c.length-1;t++){s=!1;const l=(o=c[t])==null?void 0:o.querySelector(this.STEP_POSITION_INPUT_SELECTOR),S=(r=c[t+1])==null?void 0:r.querySelector(this.STEP_POSITION_INPUT_SELECTOR),d=parseInt(l==null?void 0:l.value)+1||9999,_=parseInt(S==null?void 0:S.value)+1||9999;if(d>_){s=!0;break}}s&&((E=c[t].parentNode)==null||E.insertBefore(c[t+1],c[t]),i=!0)}}assignGlobalEvents(){const e=this.node.querySelector(this.ADD_STEP_BUTTON_SELECTOR);e.addEventListener("click",()=>this.addNewStep()),e.addEventListener("click",()=>this.updateOutput());const t=this.node.querySelector(this.GRADIENT_EXPORT_INPUT_SELECTOR);t.addEventListener("click",()=>{t.select();const c=t.value;try{navigator.clipboard.writeText(c)}catch{}});const i=this.node.querySelector(this.GRADIENT_IMPORT_BUTTON_SELECTOR),o=this.node.querySelector(this.GRADIENT_IMPORT_VIEW_SELECTOR).querySelector(this.GRADIENT_IMPORT_VIEW_CLOSE_BUTTON_SELECTOR);i==null||i.addEventListener("click",()=>{this.importGradient(),o.click()});const r=this.node.querySelector(this.FRAME_SIZE_INPUT_SELECTOR);r==null||r.addEventListener("input",()=>{this.output.size=parseInt(r.value),this.updateOutput()});const E=this.node.querySelector(this.GRADIENT_ANGLE_INPUT_SELECTOR);E==null||E.addEventListener("input",()=>{this.output.gradient&&(this.output.gradient.angle=parseInt(E.value),this.updateOutput())}),this.assignViewsVisibilityEvents()}assignViewsVisibilityEvents(){const e=this.node.querySelector(this.GRADIENT_IMPORT_VIEW_SELECTOR),t=this.node.querySelector(this.GRADIENT_IMPORT_VIEW_OPEN_BUTTON_SELECTOR),i=e.querySelector(this.GRADIENT_IMPORT_VIEW_CLOSE_BUTTON_SELECTOR),s=this.node.querySelector(this.GRADIENT_EXPORT_VIEW_SELECTOR),o=this.node.querySelector(this.GRADIENT_EXPORT_VIEW_OPEN_BUTTON_SELECTOR),r=s.querySelector(this.GRADIENT_EXPORT_VIEW_CLOSE_BUTTON_SELECTOR);t.addEventListener("click",()=>{e.classList.remove(this.HIDE_OVERLAY_VIEW_CLASS),s.classList.add(this.HIDE_OVERLAY_VIEW_CLASS)}),i.addEventListener("click",()=>{e.classList.add(this.HIDE_OVERLAY_VIEW_CLASS)}),o.addEventListener("click",()=>{s.classList.remove(this.HIDE_OVERLAY_VIEW_CLASS),e.classList.add(this.HIDE_OVERLAY_VIEW_CLASS)}),r.addEventListener("click",()=>{s.classList.add(this.HIDE_OVERLAY_VIEW_CLASS)})}reloadStoredData(e){var s,o,r,E,c,l,S;const t=this.node.querySelector(this.FRAME_SIZE_INPUT_SELECTOR),i=this.node.querySelector(this.GRADIENT_ANGLE_INPUT_SELECTOR);(e!=null&&e.size||(e==null?void 0:e.size)===0)&&(t.value=e.size.toString()),e!=null&&e.gradient&&(((s=e==null?void 0:e.gradient)!=null&&s.angle||((o=e==null?void 0:e.gradient)==null?void 0:o.angle)===0)&&(i.value=e.gradient.angle.toString()),(r=e==null?void 0:e.gradient)!=null&&r.steps&&((c=(E=e==null?void 0:e.gradient)==null?void 0:E.steps)==null?void 0:c.length)>0?(S=(l=e==null?void 0:e.gradient)==null?void 0:l.steps)==null||S.forEach(d=>{this.addNewStep(d)}):this.generateDefaultGradient())}updateOutput(){this.output=L,this.output.gradient.steps=[],this.templateSteps.forEach((i,s)=>{const o=i.querySelector(this.STEP_COLOR_INPUT_SELECTOR).value,r=parseInt(i.querySelector(this.STEP_POSITION_INPUT_SELECTOR).value);o&&r>=0&&r<=100&&this.output.gradient.steps.push({colorCode:o,position:r})});const e=this.node.querySelector(this.FRAME_SIZE_INPUT_SELECTOR),t=this.node.querySelector(this.GRADIENT_ANGLE_INPUT_SELECTOR);this.output.size=parseInt(e.value),this.output.gradient&&(this.output.gradient.angle=parseInt(t.value)),this.output.gradient.steps.sort((i,s)=>(i.position+1||9999)-(s.position+1||9999)),localStorage.setItem(this.LAST_GRADIENT_DATA_STORAGE_KEY,JSON.stringify(this.output)),this.updateExport(),this.triggerOutput()}updateExport(){const e=this.node.querySelector(this.GRADIENT_EXPORT_INPUT_SELECTOR);e.value=JSON.stringify(this.output)}importGradient(){var o,r,E;const e=this.node.querySelector(this.GRADIENT_IMPORT_INPUT_SELECTOR),t=JSON.parse(e.value);this.templateSteps.forEach(c=>this.deleteStep(c)),(r=(o=t.gradient)==null?void 0:o.steps)==null||r.forEach(c=>{const l=this.addNewStep(c);this.assignEventsToStep(l)});const i=this.node.querySelector(this.GRADIENT_ANGLE_INPUT_SELECTOR),s=this.node.querySelector(this.FRAME_SIZE_INPUT_SELECTOR);s.value=(t.size||10).toString(),i.value=(((E=t.gradient)==null?void 0:E.angle)||45).toString(),e.value="",this.sortSteps(),this.updateOutput()}triggerOutput(){this.onChange=new CustomEvent("gradientchange",{detail:{profilePictureData:this.output},bubbles:!0,cancelable:!0}),document.dispatchEvent(this.onChange)}}function h(a,e,t,i,s){return(i-t)/(e-a)*(s-a)+t}function f(a,e,t){const i=a>-1&&a<256,s=e>-1&&e<256,o=t>-1&&t<256;return i&&s&&o?(a<<16|e<<8|t).toString(16).toUpperCase():null}function p(a){return a*(Math.PI/180)}function y(a,e){var N;const t=document.querySelector("canvas"),i=t.getContext("2d"),s=t.width,o=s/2,r=h(0,100,0,s/2,a),E=o,c=o,l=o-(r-r/2);i.lineWidth=r;const d=(e.angle+90)*-1,_=Math.floor(h(-1,1,0,s,Math.sin(p(d)))),A=Math.floor(h(-1,1,0,s,Math.cos(p(d)))),g=Math.floor(h(-1,1,0,s,Math.sin(p(d+180)))),m=Math.floor(h(-1,1,0,s,Math.cos(p(d+180)))),C=i.createLinearGradient(_,A,g,m);(N=e.steps)==null||N.forEach(u=>C.addColorStop((u.position||0)/100,"#"+((u==null?void 0:u.colorCode)||"000000"))),i.strokeStyle=C,i.beginPath(),i.arc(E,c,l,0,2*Math.PI,!1),i.stroke()}class V{constructor(e){n(this,"FILE_INPUT_SELECTOR",".canvas-printer-image-input");n(this,"IMAGE_PREVIEW_SELECTOR",".canvas-printer-image-preview");n(this,"CANVAS_WRAPPER_SELECTOR",".canvas-printer-canvas-wrapper");n(this,"CANVAS_CLASS","canvas-printer-canvas");n(this,"CANVAS_SELECTOR","."+this.CANVAS_CLASS);n(this,"imageWidth",NaN);n(this,"imageHeight",NaN);n(this,"canvasSize",NaN);n(this,"_profilePictureFrameData",{});this.node=e}init(){}ready(){this.node.querySelector(this.FILE_INPUT_SELECTOR).addEventListener("change",t=>{this.getFile()})}getFile(){const e=this.node.querySelector(this.FILE_INPUT_SELECTOR),t=this.node.querySelector(this.IMAGE_PREVIEW_SELECTOR),i=e.files&&e.files[0];let s=new FileReader;s.onload=()=>{t.setAttribute("src",s.result)},t.onload=()=>{this.imageWidth=t.width,this.imageHeight=t.height,this.canvasSize=this.imageWidth<this.imageHeight?this.imageWidth:this.imageHeight,this.generateCanvas(),this.printToCanvas(this._profilePictureFrameData)},i&&s.readAsDataURL(i)}printToCanvas(e){const t=this.node.querySelector(this.IMAGE_PREVIEW_SELECTOR),i=this.node.querySelector(this.CANVAS_SELECTOR),s=this.canvasSize/2,o=i.getContext("2d"),r={angle:15,steps:I},E=(e==null?void 0:e.size)!==void 0?e==null?void 0:e.size:10,c=(e==null?void 0:e.gradient)||r;o.clearRect(0,0,this.canvasSize,this.canvasSize),o.strokeStyle="#000000",o.beginPath(),o.arc(s,s,s-1,0,Math.PI*2),o.closePath(),o.fill(),o.globalCompositeOperation="source-in";const l=this.canvasSize-this.imageWidth,S=this.canvasSize-this.imageHeight;o.drawImage(t,0,0,this.imageWidth,this.imageHeight,l/2,S/2,this.imageWidth,this.imageHeight),o.globalCompositeOperation="source-over",y(E,c),t.classList.add("hidden")}generateCanvas(){const e=this.node.querySelector(this.CANVAS_WRAPPER_SELECTOR);e.innerHTML="";const t=document.createElement("canvas");t.setAttribute("width",this.canvasSize.toString()),t.setAttribute("height",this.canvasSize.toString()),t.setAttribute("class",this.CANVAS_CLASS),e.appendChild(t),document.addEventListener(O,i=>{_profilePictureFrameData=i.detail.profilePictureData,this.printToCanvas(this._profilePictureFrameData)}),R.prototype.init()}}class G{constructor(e){n(this,"CANVAS_NODE_SELECTOR",".canvas-printer-canvas");n(this,"CANVAS_NODE",document.querySelector(this.CANVAS_NODE_SELECTOR));n(this,"isColorPickerModeActive",!1);n(this,"pointedColor","");n(this,"selectedColor","");this.node=e}init(){}ready(){this.addColorPickerEvent(),this.addColorSelectorEvent()}addColorPickerEvent(){var e;(e=this.CANVAS_NODE)==null||e.addEventListener("mousemove",t=>{this.pointedColor=this.isColorPickerModeActive?this.getColorFromCursorPosition(t):""})}addColorSelectorEvent(){var e;(e=this.CANVAS_NODE)==null||e.addEventListener("click",t=>{this.selectedColor=this.pointedColor,console.log(this.selectedColor)})}startColorPickerEvent(){this.isColorPickerModeActive=!0}stopColorPickerEvent(){this.isColorPickerModeActive=!1}getColorFromCursorPosition(e){var d,_;const t=e.currentTarget,i=(d=this.CANVAS_NODE)==null?void 0:d.width,s=e.pageX-t.offsetLeft,o=e.pageY-t.offsetTop,r=h(0,300,0,i,s),E=h(0,300,0,i,o),l=((_=this.CANVAS_NODE)==null?void 0:_.getContext("2d")).getImageData(r,E,1,1).data;return f(l[0],l[1],l[2])||"000000"}}class w{constructor(e){n(this,"SPLASH_SCREEN_NODE_SELECTOR",".splash");n(this,"START_BUTTON_SELECTOR",".splash-button-start");n(this,"GUIDE_BUTTON_SELECTOR",".splash-button-help");n(this,"GUIDE_VIEW_NODE_SELECTOR",".splash-view-guide");n(this,"SPLASH_SCREEN_CLOSED_CLASS","closed");n(this,"SPLASH_SCREEN_HIDDEN_CLASS","hidden");n(this,"GUIDE_VIEW_VISIBLE_CLASS","visible");n(this,"SPLASH_SCREEN_VIEWED_STORAGE_KEY","abs.framerJs.splash.alreadySeen");n(this,"SPLASH_SCREEN_VIEWED_VALUE",!0);this.node=e}init(){}ready(){this.detectDevice(),this.checkforSplashInit(),this.addEventsToSplashButtons()}addEventsToSplashButtons(){const e=document.querySelector(this.SPLASH_SCREEN_NODE_SELECTOR),t=e.querySelector(this.START_BUTTON_SELECTOR),i=e.querySelector(this.GUIDE_BUTTON_SELECTOR);t.addEventListener("click",()=>{this.hideSplashScreen()}),i.addEventListener("click",()=>{this.showGuideView()})}hideSplashScreen(){document.querySelector(this.SPLASH_SCREEN_NODE_SELECTOR).classList.add(this.SPLASH_SCREEN_CLOSED_CLASS),sessionStorage.setItem(this.SPLASH_SCREEN_VIEWED_STORAGE_KEY,this.SPLASH_SCREEN_VIEWED_VALUE.toString())}forceHideSplashScreen(){document.querySelector(this.SPLASH_SCREEN_NODE_SELECTOR).classList.add(this.SPLASH_SCREEN_HIDDEN_CLASS)}showGuideView(){document.querySelector(this.SPLASH_SCREEN_NODE_SELECTOR).querySelector(this.GUIDE_VIEW_NODE_SELECTOR).classList.add(this.GUIDE_VIEW_VISIBLE_CLASS)}hideGuideView(){document.querySelector(this.SPLASH_SCREEN_NODE_SELECTOR).querySelector(this.GUIDE_VIEW_NODE_SELECTOR).classList.remove(this.GUIDE_VIEW_VISIBLE_CLASS)}checkforSplashInit(){sessionStorage.getItem(this.SPLASH_SCREEN_VIEWED_STORAGE_KEY)==="true"===this.SPLASH_SCREEN_VIEWED_VALUE&&this.forceHideSplashScreen()}detectDevice(){const e="desktop";bowser.getParser(window.navigator.userAgent).parsedResult.platform.type!==e&&document.querySelector(".unsupported-device-warning").classList.remove("hidden")}}const U=new T;[R,V,G,w].forEach(a=>{U.registerComponent(a.prototype.constructor.name,a)});
